include (ExternalProject)

set(FLATBUFFERS_URL ${CMAKE_CURRENT_BINARY_DIR}/third_party/flatbuffers/src/flatbuffers)

if (THIRD_PARTY)

ExternalProject_Add(flatbuffers
    PREFIX flatbuffers
    URL ${FLATBUFFERS_URL}
    UPDATE_COMMAND ""
    BUILD_IN_SOURCE 1
    SOURCE_DIR ${CMAKE_CURRENT_BINARY_DIR}/flatbuffers/src/flatbuffers
    CMAKE_ARGS -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=${THIRD_PARTY_DIR}/flatbuffers
)

endif(THIRD_PARTY)

set(FLATBUFFERS_INCLUDE_DIR ${THIRD_PARTY_DIR}/flatbuffers/include)
set(FLATBUFFERS_LIBRARY_DIR ${THIRD_PARTY_DIR}/flatbuffers/lib)
set(FLATBUFFERS_BINARY_DIR ${THIRD_PARTY_DIR}/flatbuffers/bin)

set(PROTOC_EXECUTABLE_NAME flatc)
set(FLATBUFFERS_PROTOC_EXECUTABLE ${FLATBUFFERS_BINARY_DIR}/${PROTOC_EXECUTABLE_NAME})

set(FLATBUFFERS_LIBRARY_NAMES libflatbuffers.a)
foreach(LIBRARY_NAME ${FLATBUFFERS_LIBRARY_NAMES})
    list(APPEND FLATBUFFERS_STATIC_LIBRARIES ${FLATBUFFERS_LIBRARY_DIR}/${LIBRARY_NAME})
endforeach()
